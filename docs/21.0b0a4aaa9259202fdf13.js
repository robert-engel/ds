(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{qriC:function(t,e,i){"use strict";i.r(e),i.d(e,"ScavengeModule",(function(){return Z}));var a=i("ofXK"),s=i("tyNb"),n=i("XNiG"),c=i("1G5W"),l=i("fXoL"),o=i("M9ds"),b=i("PDjf");const r=function(t){return[t]};function d(t,e){if(1&t){const t=l.Vb();l.Ub(0,"span",2),l.fc("click",(function(){l.Ac(t);const i=e.$implicit;return l.jc().activeLink=i})),l.Lc(1),l.Tb()}if(2&t){const t=e.$implicit,i=l.jc();l.pc("active",i.activeLink===t)("routerLink",l.tc(3,r,t.link)),l.Bb(1),l.Nc(" ",t.title," ")}}let u=(()=>{class t{constructor(t){this.router=t,this.links=[{title:"Home",link:"/scavenge"}],this.activeLink=this.links[0],this.unsub$=new n.b}ngOnInit(){this.setActive(),this.router.events.pipe(Object(c.a)(this.unsub$)).subscribe(t=>{this.setActive()})}setActive(){for(const t of this.links)this.router.isActive(t.link,!1)&&(this.activeLink=t)}ngOnDestroy(){this.unsub$.next(),this.unsub$.complete()}}return t.\u0275fac=function(e){return new(e||t)(l.Ob(s.c))},t.\u0275cmp=l.Ib({type:t,selectors:[["app-scavenge"]],decls:4,vars:1,consts:[["mat-tab-nav-bar",""],["mat-tab-link","",3,"active","routerLink","click",4,"ngFor","ngForOf"],["mat-tab-link","",3,"active","routerLink","click"]],template:function(t,e){1&t&&(l.Ub(0,"nav",0),l.Jc(1,d,2,5,"span",1),l.Tb(),l.Ub(2,"mat-card"),l.Pb(3,"router-outlet"),l.Tb()),2&t&&(l.Bb(1),l.pc("ngForOf",e.links))},directives:[o.b,a.l,b.a,s.g,o.a,s.d],styles:[""]}),t})();var m=i("3Pt+"),f=i("iELJ"),v=i("Vfqt"),h=i("5eHb"),p=i("NFeN"),g=i("ZFy/"),T=i("38Pe"),U=i("bTqV"),k=i("7Ixi"),w=i("e6WT"),y=i("OaSA"),C=i("irRR");function L(t,e){1&t&&(l.Ub(0,"th",24),l.Lc(1,"Dorf"),l.Tb())}function R(t,e){if(1&t&&(l.Ub(0,"td",25),l.Pb(1,"app-village-render",26),l.Tb()),2&t){const t=e.$implicit;l.Bb(1),l.pc("value",t)}}function D(t,e){1&t&&l.Pb(0,"th",24)}function x(t,e){if(1&t){const t=l.Vb();l.Ub(0,"td",25),l.Ub(1,"button",27),l.fc("click",(function(){l.Ac(t);const i=e.$implicit;return l.jc(2).removeVillage(i.id)})),l.Ub(2,"mat-icon"),l.Lc(3,"delete"),l.Tb(),l.Tb(),l.Tb()}}function V(t,e){1&t&&l.Pb(0,"tr",28)}function $(t,e){1&t&&l.Pb(0,"tr",29)}function B(t,e){if(1&t&&(l.Ub(0,"div",16),l.Ub(1,"table",17),l.Sb(2,18),l.Jc(3,L,2,0,"th",19),l.Jc(4,R,2,1,"td",20),l.Rb(),l.Sb(5,21),l.Jc(6,D,1,0,"th",19),l.Jc(7,x,4,0,"td",20),l.Rb(),l.Jc(8,V,1,0,"tr",22),l.Jc(9,$,1,0,"tr",23),l.Tb(),l.Tb()),2&t){const t=l.jc();l.Bb(1),l.pc("dataSource",t.data.villages),l.Bb(7),l.pc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.pc("matRowDefColumns",t.displayedColumns)}}let O=(()=>{class t{constructor(t,e,i,a){this.data=t,this.dialogRef=e,this.scavenge=i,this.toastr=a,this.unsub$=new n.b,this.form=new m.e({},m.v.required),this.villageForm=new m.e("",m.v.required),this.massVillageForm=new m.e("",m.v.required),this.nonFarmUnits=["militia","ram","catapult","snob","spy"],this.displayedColumns=["village","delete"],this.form.setValue(t.troops)}ngOnInit(){this.scavenge.taskEditEvent(this.unsub$).subscribe(t=>{t.id===this.data.id&&(this.toastr.success("Erfolgreich bearbeitet.",void 0,{timeOut:7e3}),this.form.enable())}),this.scavenge.villageAddedEvent(this.unsub$).subscribe(t=>{t.id===this.data.id&&(this.data.villages=[...this.data.villages,...t.villages])}),this.scavenge.villageRemovedEvent(this.unsub$).subscribe(t=>{t.id===this.data.id&&(this.data.villages=this.data.villages.filter(e=>!t.villages.includes(e.id)))})}massAdd(){this.scavenge.massAddVillage(this.data.id,this.massVillageForm.value)}massRemove(){this.scavenge.massRemoveVillage(this.data.id,this.massVillageForm.value)}addVillage(){this.scavenge.addVillage(this.data.id,this.villageForm.value.id)}removeVillage(t){this.scavenge.removeVillage(this.data.id,t)}submit(t){this.form.disable(),this.scavenge.editTask(this.data.id,t)}ngOnDestroy(){this.unsub$.next(),this.unsub$.complete()}}return t.\u0275fac=function(e){return new(e||t)(l.Ob(f.a),l.Ob(f.g),l.Ob(v.a),l.Ob(h.b))},t.\u0275cmp=l.Ib({type:t,selectors:[["app-scavenge-task-edit"]],decls:33,vars:10,consts:[[1,"row"],[1,"col-xl-12"],[1,"form-group","row"],[1,"col-xl-3"],["matTooltip","Maximale Einheiten die \xfcber alle Raubz\xfcge verteilt werden."],[1,"col-xl-9"],[3,"formControl","excludeUnits"],[1,"col-xl-12","flex-between"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],[1,"col-xl-6"],[1,"col-md-9"],[3,"formControl","onlyOwn"],["mat-raised-button","","color","primary",3,"disabled","click"],["placeholder","Massen Hinzuf\xfcgen/Entfernen","matInput","",3,"formControl"],["mat-raised-button","","color","primary",1,"mt-1",3,"disabled","click"],["class","col-xl-6 list",4,"ngIf"],[1,"col-xl-6","list"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","village"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"value"],["type","button","mat-mini-fab","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(l.Ub(0,"div",0),l.Ub(1,"div",1),l.Ub(2,"div",2),l.Ub(3,"div",3),l.Ub(4,"label"),l.Lc(5,"Einheiten "),l.Ub(6,"mat-icon",4),l.Lc(7,"info "),l.Tb(),l.Tb(),l.Tb(),l.Ub(8,"div",5),l.Pb(9,"app-units-input",6),l.Tb(),l.Tb(),l.Ub(10,"div",2),l.Ub(11,"div",7),l.Pb(12,"span"),l.Ub(13,"button",8),l.fc("click",(function(){return e.submit(e.form.value)})),l.Lc(14," Bearbeiten "),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Ub(15,"div",0),l.Ub(16,"div",9),l.Ub(17,"div",0),l.Ub(18,"div",10),l.Pb(19,"app-village-input",11),l.Tb(),l.Ub(20,"div",3),l.Ub(21,"button",12),l.fc("click",(function(){return e.addVillage()})),l.Lc(22," Dorf hinzuf\xfcgen. "),l.Tb(),l.Tb(),l.Tb(),l.Ub(23,"div",0),l.Ub(24,"div",10),l.Pb(25,"textarea",13),l.Tb(),l.Ub(26,"div",3),l.Ub(27,"button",12),l.fc("click",(function(){return e.massAdd()})),l.Lc(28," D\xf6rfer hinzuf\xfcgen. "),l.Tb(),l.Pb(29,"br"),l.Ub(30,"button",14),l.fc("click",(function(){return e.massRemove()})),l.Lc(31," D\xf6rfer entfernen. "),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Jc(32,B,10,3,"div",15),l.Tb()),2&t&&(l.Bb(9),l.pc("formControl",e.form)("excludeUnits",e.nonFarmUnits),l.Bb(4),l.pc("disabled",!e.form.valid||e.form.disabled),l.Bb(6),l.pc("formControl",e.villageForm)("onlyOwn",!0),l.Bb(2),l.pc("disabled",e.villageForm.disabled||e.villageForm.invalid),l.Bb(4),l.pc("formControl",e.massVillageForm),l.Bb(2),l.pc("disabled",e.massVillageForm.disabled||e.massVillageForm.invalid),l.Bb(3),l.pc("disabled",e.massVillageForm.disabled||e.massVillageForm.invalid),l.Bb(2),l.pc("ngIf",e.data.villages.length>0))},directives:[p.a,g.a,T.a,m.o,m.f,U.a,k.a,w.b,m.c,a.m,y.j,y.c,y.e,y.b,y.g,y.i,y.d,y.a,C.a,y.f,y.h],styles:[""]}),t})(),F=(()=>{class t{constructor(t,e){this.dialogRef=t,this.scavenge=e,this.form=new m.e({},m.v.required),this.nonFarmUnits=["militia","ram","catapult","snob","spy"]}ngOnInit(){}submit(t){this.form.disable(),this.scavenge.addTask(t)}}return t.\u0275fac=function(e){return new(e||t)(l.Ob(f.g),l.Ob(v.a))},t.\u0275cmp=l.Ib({type:t,selectors:[["app-scavenge-task-add"]],decls:15,vars:3,consts:[[1,"row"],[1,"col-xl-12"],[1,"form-group","row"],[1,"col-xl-3"],["matTooltip","Maximale Einheiten die \xfcber alle Raubz\xfcge verteilt werden."],[1,"col-xl-9"],[3,"formControl","excludeUnits"],[1,"col-xl-12","flex-between"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,e){1&t&&(l.Ub(0,"div",0),l.Ub(1,"div",1),l.Ub(2,"div",2),l.Ub(3,"div",3),l.Ub(4,"label"),l.Lc(5,"Einheiten "),l.Ub(6,"mat-icon",4),l.Lc(7," info "),l.Tb(),l.Tb(),l.Tb(),l.Ub(8,"div",5),l.Pb(9,"app-units-input",6),l.Tb(),l.Tb(),l.Ub(10,"div",2),l.Ub(11,"div",7),l.Pb(12,"span"),l.Ub(13,"button",8),l.fc("click",(function(){return e.submit(e.form.value)})),l.Lc(14," Hinzuf\xfcgen "),l.Tb(),l.Tb(),l.Tb(),l.Tb(),l.Tb()),2&t&&(l.Bb(9),l.pc("formControl",e.form)("excludeUnits",e.nonFarmUnits),l.Bb(4),l.pc("disabled",!e.form.valid||e.form.disabled))},directives:[p.a,g.a,T.a,m.o,m.f,U.a],styles:[""]}),t})();var P=i("hC39");function J(t,e){1&t&&(l.Ub(0,"th",10),l.Lc(1,"D\xf6rfer"),l.Tb())}function E(t,e){if(1&t&&(l.Ub(0,"td",11),l.Lc(1),l.Tb()),2&t){const t=e.$implicit;l.Bb(1),l.Nc(" ",t.villages.length," ")}}function j(t,e){1&t&&(l.Ub(0,"th",10),l.Lc(1,"Einheiten"),l.Tb())}function A(t,e){if(1&t&&(l.Ub(0,"td",11),l.Pb(1,"app-units-render-min",12),l.Tb()),2&t){const t=e.$implicit;l.Bb(1),l.pc("value",t.troops)}}function I(t,e){if(1&t){const t=l.Vb();l.Ub(0,"th",10),l.Ub(1,"button",13),l.fc("click",(function(){return l.Ac(t),l.jc(2).add()})),l.Ub(2,"mat-icon"),l.Lc(3,"add"),l.Tb(),l.Tb(),l.Tb()}}function S(t,e){if(1&t){const t=l.Vb();l.Ub(0,"td",11),l.Ub(1,"button",14),l.fc("click",(function(){l.Ac(t);const i=e.$implicit;return l.jc(2).edit(i)})),l.Ub(2,"mat-icon"),l.Lc(3,"edit"),l.Tb(),l.Tb(),l.Ub(4,"button",15),l.fc("click",(function(){l.Ac(t);const i=e.$implicit;return l.jc(2).delete(i.id)})),l.Ub(5,"mat-icon"),l.Lc(6,"delete"),l.Tb(),l.Tb(),l.Tb()}}function H(t,e){1&t&&l.Pb(0,"tr",16)}function M(t,e){1&t&&l.Pb(0,"tr",17)}function q(t,e){if(1&t&&(l.Ub(0,"table",2),l.Sb(1,3),l.Jc(2,J,2,0,"th",4),l.Jc(3,E,2,1,"td",5),l.Rb(),l.Sb(4,6),l.Jc(5,j,2,0,"th",4),l.Jc(6,A,2,1,"td",5),l.Rb(),l.Sb(7,7),l.Jc(8,I,4,0,"th",4),l.Jc(9,S,7,0,"td",5),l.Rb(),l.Jc(10,H,1,0,"tr",8),l.Jc(11,M,1,0,"tr",9),l.Tb()),2&t){const t=l.jc();l.pc("dataSource",t.tasks),l.Bb(10),l.pc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.pc("matRowDefColumns",t.displayedColumns)}}function z(t,e){if(1&t){const t=l.Vb();l.Ub(0,"div",18),l.Ub(1,"div",19),l.Pb(2,"span"),l.Ub(3,"span",20),l.Lc(4," Keine Tasks vorhanden."),l.Pb(5,"br"),l.Ub(6,"button",21),l.fc("click",(function(){return l.Ac(t),l.jc().add()})),l.Lc(7," Hinzuf\xfcgen. "),l.Tb(),l.Tb(),l.Pb(8,"span"),l.Tb(),l.Tb()}}const N=[{path:"",component:u,children:[{path:"",pathMatch:"full",component:(()=>{class t{constructor(t,e){this.scavenge=t,this.dialog=e,this.unsub$=new n.b,this.slide=new m.e,this.dialogRef=void 0,this.displayedColumns=["villages","units","control"]}ngOnInit(){this.scavenge.listTasks().subscribe(t=>{this.tasks=t}),this.scavenge.enableEvent(this.unsub$).subscribe(t=>{this.slide.setValue(t,{emitEvent:!1})}),this.slide.valueChanges.subscribe(t=>{this.scavenge.setEnabled(t)}),this.scavenge.taskEditEvent(this.unsub$).subscribe(t=>{this.tasks=this.tasks.map(e=>e.id===t.id?t:e)}),this.scavenge.taskAddedEvent(this.unsub$).subscribe(t=>{void 0!==this.dialogRef&&(this.dialogRef.close(),this.tasks=[...this.tasks,t],this.dialog.open(O,{data:t}))}),this.scavenge.taskRemovedEvent(this.unsub$).subscribe(t=>{this.tasks=this.tasks.filter(e=>e.id!==t)})}delete(t){this.scavenge.removeTask(t)}edit(t){this.dialog.open(O,{data:t})}add(){this.dialogRef=this.dialog.open(F)}ngOnDestroy(){this.unsub$.next(),this.unsub$.complete()}}return t.\u0275fac=function(e){return new(e||t)(l.Ob(v.a),l.Ob(f.b))},t.\u0275cmp=l.Ib({type:t,selectors:[["app-scavenge-overview"]],decls:2,vars:2,consts:[["mat-table","","class","w-100",3,"dataSource",4,"ngIf"],["class","row",4,"ngIf"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","villages"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","units"],["matColumnDef","control"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"value"],["mat-mini-fab","","color","primary",3,"click"],["mat-mini-fab","",1,"mr-2",3,"click"],["mat-mini-fab","","matTooltip","Unwiderruflich l\xf6schen.",3,"click"],["mat-header-row",""],["mat-row",""],[1,"row"],[1,"col-xl-12","flex-between"],[1,"text-center"],["mat-raised-button","",3,"click"]],template:function(t,e){1&t&&(l.Jc(0,q,12,3,"table",0),l.Jc(1,z,9,0,"div",1)),2&t&&(l.pc("ngIf",e.tasks&&e.tasks.length>0),l.Bb(1),l.pc("ngIf",e.tasks&&0===e.tasks.length))},directives:[a.m,y.j,y.c,y.e,y.b,y.g,y.i,y.d,y.a,P.a,U.a,p.a,g.a,y.f,y.h],styles:[".mat-column-control[_ngcontent-%COMP%]{width:10%}"]}),t})()}]}];let W=(()=>{class t{}return t.\u0275mod=l.Mb({type:t}),t.\u0275inj=l.Lb({factory:function(e){return new(e||t)},imports:[[s.f.forChild(N)],s.f]}),t})();var X=i("BLWB"),G=i("Q2Ze"),K=i("jMqV");let Z=(()=>{class t{}return t.\u0275mod=l.Mb({type:t}),t.\u0275inj=l.Lb({factory:function(e){return new(e||t)},imports:[[a.c,W,o.c,b.f,X.a,p.b,g.b,U.b,m.t,G.d,w.c,y.l,K.b]]}),t})()}}]);